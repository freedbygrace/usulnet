// Code generated by templ - DO NOT EDIT.

// templ: version: v0.3.977
package pages

//lint:file-ignore SA4006 This context is only used if a nested component is present.

import "github.com/a-h/templ"
import templruntime "github.com/a-h/templ/runtime"

import "github.com/fr4nsys/usulnet/internal/web/templates/layouts"

type TOTPSetupData struct {
	PageData  layouts.PageData
	Error     string
	Success   string
	Secret    string // Base32 secret (shown to user for manual entry)
	QRCodeURI string // otpauth:// URI for QR generation
	CSRFToken string
	Username  string
	Enabled   bool // Whether TOTP is currently enabled
}

func TOTPSetup(data TOTPSetupData) templ.Component {
	return templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
		templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
		if templ_7745c5c3_CtxErr := ctx.Err(); templ_7745c5c3_CtxErr != nil {
			return templ_7745c5c3_CtxErr
		}
		templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
		if !templ_7745c5c3_IsBuffer {
			defer func() {
				templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
				if templ_7745c5c3_Err == nil {
					templ_7745c5c3_Err = templ_7745c5c3_BufErr
				}
			}()
		}
		ctx = templ.InitializeContext(ctx)
		templ_7745c5c3_Var1 := templ.GetChildren(ctx)
		if templ_7745c5c3_Var1 == nil {
			templ_7745c5c3_Var1 = templ.NopComponent
		}
		ctx = templ.ClearChildren(ctx)
		templ_7745c5c3_Var2 := templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
			templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
			templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
			if !templ_7745c5c3_IsBuffer {
				defer func() {
					templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
					if templ_7745c5c3_Err == nil {
						templ_7745c5c3_Err = templ_7745c5c3_BufErr
					}
				}()
			}
			ctx = templ.InitializeContext(ctx)
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 1, "<div class=\"max-w-2xl mx-auto\"><!-- Header --><div class=\"flex items-center gap-4 mb-8\"><a href=\"/settings\" class=\"p-2 rounded-lg hover:bg-dark-700 text-gray-400 hover:text-white transition-colors\"><i class=\"fas fa-arrow-left\"></i></a><div><h1 class=\"text-2xl font-bold font-display text-white\">Two-Factor Authentication</h1><p class=\"text-sm text-gray-400 mt-1\">Secure your account with TOTP-based 2FA</p></div></div>")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			if data.Error != "" {
				templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 2, "<div class=\"mb-6 p-4 rounded-lg bg-red-500/10 border border-red-500/20 text-red-400 text-sm flex items-start gap-3\"><i class=\"fas fa-exclamation-circle mt-0.5\"></i> <span>")
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
				var templ_7745c5c3_Var3 string
				templ_7745c5c3_Var3, templ_7745c5c3_Err = templ.JoinStringErrs(data.Error)
				if templ_7745c5c3_Err != nil {
					return templ.Error{Err: templ_7745c5c3_Err, FileName: `internal/web/templates/pages/totp_setup.templ`, Line: 33, Col: 23}
				}
				_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var3))
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
				templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 3, "</span></div>")
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
			}
			if data.Success != "" {
				templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 4, "<div class=\"mb-6 p-4 rounded-lg bg-green-500/10 border border-green-500/20 text-green-400 text-sm flex items-start gap-3\"><i class=\"fas fa-check-circle mt-0.5\"></i> <span>")
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
				var templ_7745c5c3_Var4 string
				templ_7745c5c3_Var4, templ_7745c5c3_Err = templ.JoinStringErrs(data.Success)
				if templ_7745c5c3_Err != nil {
					return templ.Error{Err: templ_7745c5c3_Err, FileName: `internal/web/templates/pages/totp_setup.templ`, Line: 40, Col: 25}
				}
				_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var4))
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
				templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 5, "</span></div>")
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
			}
			if data.Enabled {
				templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 6, "<!-- 2FA is enabled --> <div class=\"bg-dark-800 rounded-xl border border-dark-600 p-6\"><div class=\"flex items-center gap-4 mb-6\"><div class=\"flex items-center justify-center w-12 h-12 rounded-xl bg-green-500/10\"><i class=\"fas fa-shield-alt text-green-400 text-xl\"></i></div><div><h2 class=\"text-lg font-semibold text-white\">2FA Enabled</h2><p class=\"text-sm text-gray-400\">Your account is protected with two-factor authentication</p></div></div><div class=\"p-4 rounded-lg bg-yellow-500/5 border border-yellow-500/20 mb-6\"><p class=\"text-sm text-yellow-400\"><i class=\"fas fa-exclamation-triangle mr-2\"></i> Disabling 2FA will reduce your account security. You'll need to enter your current TOTP code to confirm.</p></div><form method=\"POST\" action=\"/settings/totp/disable\" class=\"flex items-end gap-4\" x-data=\"{ confirm: false }\"><input type=\"hidden\" name=\"csrf_token\" value=\"")
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
				var templ_7745c5c3_Var5 string
				templ_7745c5c3_Var5, templ_7745c5c3_Err = templ.JoinStringErrs(data.CSRFToken)
				if templ_7745c5c3_Err != nil {
					return templ.Error{Err: templ_7745c5c3_Err, FileName: `internal/web/templates/pages/totp_setup.templ`, Line: 65, Col: 67}
				}
				_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var5))
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
				templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 7, "\"><div class=\"flex-1\" x-show=\"confirm\" x-cloak><label for=\"disable_code\" class=\"block text-sm font-medium text-gray-300 mb-2\">Current TOTP Code</label> <input type=\"text\" id=\"disable_code\" name=\"totp_code\" autocomplete=\"one-time-code\" inputmode=\"numeric\" pattern=\"[0-9]{6}\" maxlength=\"6\" class=\"w-full px-4 py-2.5 rounded-lg bg-dark-700 border border-dark-600 text-white text-center font-mono tracking-wider placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-red-500/50 focus:border-red-500 transition-colors\" placeholder=\"000000\"></div><button x-show=\"!confirm\" type=\"button\" @click=\"confirm = true\" class=\"px-4 py-2.5 bg-red-500/10 hover:bg-red-500/20 text-red-400 rounded-lg border border-red-500/20 transition-colors text-sm\"><i class=\"fas fa-times mr-2\"></i>Disable 2FA</button> <button x-show=\"confirm\" x-cloak type=\"submit\" class=\"px-4 py-2.5 bg-red-600 hover:bg-red-700 text-white rounded-lg transition-colors text-sm\">Confirm Disable</button> <button x-show=\"confirm\" x-cloak type=\"button\" @click=\"confirm = false\" class=\"px-4 py-2.5 bg-dark-700 hover:bg-dark-600 text-gray-300 rounded-lg transition-colors text-sm\">Cancel</button></form></div>")
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
			} else {
				templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 8, "<!-- 2FA setup flow --> <div class=\"bg-dark-800 rounded-xl border border-dark-600 p-6\"><div class=\"flex items-center gap-4 mb-6\"><div class=\"flex items-center justify-center w-12 h-12 rounded-xl bg-primary-500/10\"><i class=\"fas fa-qrcode text-primary-400 text-xl\"></i></div><div><h2 class=\"text-lg font-semibold text-white\">Setup Authenticator</h2><p class=\"text-sm text-gray-400\">Scan the QR code with your authenticator app</p></div></div><!-- Step 1: QR Code --><div class=\"mb-6\"><div class=\"flex justify-center mb-4\"><div id=\"qrcode\" class=\"bg-white p-4 rounded-xl inline-block\" data-uri=\"")
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
				var templ_7745c5c3_Var6 string
				templ_7745c5c3_Var6, templ_7745c5c3_Err = templ.JoinStringErrs(data.QRCodeURI)
				if templ_7745c5c3_Err != nil {
					return templ.Error{Err: templ_7745c5c3_Err, FileName: `internal/web/templates/pages/totp_setup.templ`, Line: 125, Col: 94}
				}
				_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var6))
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
				templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 9, "\"></div></div><p class=\"text-center text-xs text-gray-500 mb-4\">Compatible with Google Authenticator, Authy, 1Password, Bitwarden, etc.</p></div><!-- Step 2: Manual key --><div class=\"mb-6\" x-data=\"{ showKey: false, copied: false }\"><button type=\"button\" @click=\"showKey = !showKey\" class=\"w-full text-left text-sm text-gray-400 hover:text-primary-400 transition-colors flex items-center gap-2\"><i class=\"fas fa-keyboard\"></i> <span x-show=\"!showKey\">Cannot scan? Enter key manually</span> <span x-show=\"showKey\" x-cloak>Hide manual key</span> <i class=\"fas fa-chevron-down text-xs ml-auto transition-transform\" x-bind:class=\"showKey ? 'rotate-180' : ''\"></i></button><div x-show=\"showKey\" x-cloak class=\"mt-3 p-4 rounded-lg bg-dark-700 border border-dark-600\"><label class=\"block text-xs font-medium text-gray-400 mb-2\">Secret Key</label><div class=\"flex items-center gap-2\"><code id=\"totp-secret\" class=\"flex-1 px-3 py-2 rounded bg-dark-900 text-primary-400 font-mono text-sm tracking-wider break-all select-all\">")
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
				var templ_7745c5c3_Var7 string
				templ_7745c5c3_Var7, templ_7745c5c3_Err = templ.JoinStringErrs(formatSecret(data.Secret))
				if templ_7745c5c3_Err != nil {
					return templ.Error{Err: templ_7745c5c3_Err, FileName: `internal/web/templates/pages/totp_setup.templ`, Line: 147, Col: 174}
				}
				_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var7))
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
				templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 10, "</code> <button type=\"button\" @click=\"var t=document.getElementById('totp-secret').textContent.split(' ').join('');navigator.clipboard.writeText(t);copied=true;setTimeout(()=>copied=false,2000)\" class=\"p-2 rounded-lg hover:bg-dark-600 text-gray-400 hover:text-white transition-colors\" title=\"Copy to clipboard\"><i class=\"fas fa-copy\" x-show=\"!copied\"></i> <i class=\"fas fa-check text-green-400\" x-show=\"copied\" x-cloak></i></button></div><p class=\"mt-2 text-xs text-gray-500\">Type: TOTP · Algorithm: SHA1 · Digits: 6 · Period: 30s</p></div></div><!-- Step 3: Verify --><form method=\"POST\" action=\"/settings/totp/verify\" class=\"border-t border-dark-600 pt-6\"><input type=\"hidden\" name=\"csrf_token\" value=\"")
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
				var templ_7745c5c3_Var8 string
				templ_7745c5c3_Var8, templ_7745c5c3_Err = templ.JoinStringErrs(data.CSRFToken)
				if templ_7745c5c3_Err != nil {
					return templ.Error{Err: templ_7745c5c3_Err, FileName: `internal/web/templates/pages/totp_setup.templ`, Line: 164, Col: 67}
				}
				_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var8))
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
				templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 11, "\"> <label for=\"verify_code\" class=\"block text-sm font-medium text-gray-300 mb-2\"><i class=\"fas fa-check-circle mr-1 text-primary-400\"></i> Verify — enter the code shown in your app</label><div class=\"flex gap-3\"><input type=\"text\" id=\"verify_code\" name=\"totp_code\" required autocomplete=\"one-time-code\" inputmode=\"numeric\" pattern=\"[0-9]{6}\" maxlength=\"6\" class=\"flex-1 px-4 py-2.5 rounded-lg bg-dark-700 border border-dark-600 text-white text-center font-mono text-lg tracking-[0.4em] placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-primary-500/50 focus:border-primary-500 transition-colors\" placeholder=\"000000\"> <button type=\"submit\" class=\"px-6 py-2.5 bg-gradient-to-r from-primary-500 to-primary-600 hover:from-primary-600 hover:to-primary-700 text-black font-medium rounded-lg shadow-lg shadow-primary-500/25 transition-all\">Enable 2FA</button></div></form></div><!-- QR Code script --> <script src=\"/static/vendor/qrcodejs/qrcode.min.js\"></script> <script>\n\t\t\t\t\tdocument.addEventListener('DOMContentLoaded', function() {\n\t\t\t\t\t\tvar el = document.getElementById('qrcode');\n\t\t\t\t\t\tif (el) {\n\t\t\t\t\t\t\tnew QRCode(el, {\n\t\t\t\t\t\t\t\ttext: el.getAttribute('data-uri'),\n\t\t\t\t\t\t\t\twidth: 200,\n\t\t\t\t\t\t\t\theight: 200,\n\t\t\t\t\t\t\t\tcolorDark: '#000000',\n\t\t\t\t\t\t\t\tcolorLight: '#ffffff',\n\t\t\t\t\t\t\t\tcorrectLevel: QRCode.CorrectLevel.M,\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t</script>")
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 12, "</div>")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			return nil
		})
		templ_7745c5c3_Err = layouts.Base(data.PageData).Render(templ.WithChildren(ctx, templ_7745c5c3_Var2), templ_7745c5c3_Buffer)
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		return nil
	})
}

// formatSecret formats a base32 secret with spaces every 4 chars for readability.
func formatSecret(secret string) string {
	var parts []string
	for i := 0; i < len(secret); i += 4 {
		end := i + 4
		if end > len(secret) {
			end = len(secret)
		}
		parts = append(parts, secret[i:end])
	}
	result := ""
	for i, part := range parts {
		if i > 0 {
			result += " "
		}
		result += part
	}
	return result
}

var _ = templruntime.GeneratedTemplate
