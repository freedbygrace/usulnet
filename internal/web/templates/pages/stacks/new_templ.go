// Code generated by templ - DO NOT EDIT.

// templ: version: v0.3.977
package stacks

//lint:file-ignore SA4006 This context is only used if a nested component is present.

import "github.com/a-h/templ"
import templruntime "github.com/a-h/templ/runtime"

import "github.com/fr4nsys/usulnet/internal/web/templates/layouts"

type StackNewData struct {
	PageData layouts.PageData
	Error    string
}

func New(data StackNewData) templ.Component {
	return templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
		templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
		if templ_7745c5c3_CtxErr := ctx.Err(); templ_7745c5c3_CtxErr != nil {
			return templ_7745c5c3_CtxErr
		}
		templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
		if !templ_7745c5c3_IsBuffer {
			defer func() {
				templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
				if templ_7745c5c3_Err == nil {
					templ_7745c5c3_Err = templ_7745c5c3_BufErr
				}
			}()
		}
		ctx = templ.InitializeContext(ctx)
		templ_7745c5c3_Var1 := templ.GetChildren(ctx)
		if templ_7745c5c3_Var1 == nil {
			templ_7745c5c3_Var1 = templ.NopComponent
		}
		ctx = templ.ClearChildren(ctx)
		templ_7745c5c3_Var2 := templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
			templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
			templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
			if !templ_7745c5c3_IsBuffer {
				defer func() {
					templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
					if templ_7745c5c3_Err == nil {
						templ_7745c5c3_Err = templ_7745c5c3_BufErr
					}
				}()
			}
			ctx = templ.InitializeContext(ctx)
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 1, "<div class=\"max-w-5xl mx-auto space-y-6\" x-data=\"composeEditor()\"><!-- Header --><div class=\"flex items-center gap-4\"><a href=\"/stacks\" class=\"p-2 text-gray-400 hover:text-white hover:bg-dark-700 rounded-lg\"><i class=\"fas fa-arrow-left\"></i></a><div><h1 class=\"text-2xl font-display font-bold text-white\">New Stack</h1><p class=\"text-gray-400 mt-1\">Deploy a Docker Compose stack</p></div></div><!-- Quick Link to Catalog --><div class=\"bg-dark-800/50 border border-dark-600 rounded-lg p-4 flex items-center justify-between\"><div class=\"flex items-center gap-3 text-gray-400\"><i class=\"fas fa-lightbulb text-yellow-400\"></i> <span class=\"text-sm\">Looking for something quicker? Use the pre-configured templates in Apps.</span></div><a href=\"/stacks/catalog\" class=\"btn-secondary text-sm\"><i class=\"fas fa-store mr-1.5\"></i>Apps</a></div>")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			if data.Error != "" {
				templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 2, "<div class=\"bg-red-500/10 border border-red-500/20 rounded-lg p-4 text-red-400\"><i class=\"fas fa-exclamation-circle mr-2\"></i>")
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
				var templ_7745c5c3_Var3 string
				templ_7745c5c3_Var3, templ_7745c5c3_Err = templ.JoinStringErrs(data.Error)
				if templ_7745c5c3_Err != nil {
					return templ.Error{Err: templ_7745c5c3_Err, FileName: `internal/web/templates/pages/stacks/new.templ`, Line: 37, Col: 63}
				}
				_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var3))
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
				templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 3, "</div>")
				if templ_7745c5c3_Err != nil {
					return templ_7745c5c3_Err
				}
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 4, "<!-- Deploy error (shown by JS) --><div x-show=\"deployError\" x-cloak class=\"bg-red-500/10 border border-red-500/20 rounded-lg p-4 text-red-400\"><i class=\"fas fa-exclamation-circle mr-2\"></i><span x-text=\"deployError\"></span></div><!-- Form --><form @submit.prevent=\"deployStack\" class=\"space-y-6\"><input type=\"hidden\" name=\"csrf_token\" value=\"")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			var templ_7745c5c3_Var4 string
			templ_7745c5c3_Var4, templ_7745c5c3_Err = templ.JoinStringErrs(data.PageData.CSRFToken)
			if templ_7745c5c3_Err != nil {
				return templ.Error{Err: templ_7745c5c3_Err, FileName: `internal/web/templates/pages/stacks/new.templ`, Line: 48, Col: 74}
			}
			_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var4))
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 5, "\" x-ref=\"csrfToken\"><div class=\"card p-6 space-y-4\"><div><label for=\"name\" class=\"block text-sm font-medium text-gray-300 mb-2\">Stack Name</label> <input type=\"text\" id=\"name\" name=\"name\" required x-model=\"stackName\" class=\"input\" placeholder=\"my-stack\"></div><div class=\"flex items-center gap-3\"><input type=\"checkbox\" id=\"pull\" name=\"pull\" checked class=\"rounded border-dark-600 bg-dark-700 text-primary-500 focus:ring-primary-500\"> <label for=\"pull\" class=\"text-sm text-gray-300\">Pull latest images before deploying</label></div></div><div class=\"card overflow-hidden\"><!-- Editor Toolbar --><div class=\"flex items-center justify-between px-4 py-2 bg-dark-850 border-b border-dark-600\"><div class=\"flex items-center gap-3\"><span class=\"text-sm font-medium text-white\"><i class=\"fas fa-file-code text-blue-400 mr-2\"></i>docker-compose.yml</span> <span class=\"text-xs px-2 py-0.5 rounded bg-dark-700 text-gray-400\">YAML</span></div><div class=\"flex items-center gap-2\"><!-- Snippets dropdown --><div class=\"relative\" x-data=\"{ open: false }\"><button type=\"button\" @click=\"open = !open\" class=\"btn-ghost text-sm\"><i class=\"fas fa-code mr-1\"></i>Snippets <i class=\"fas fa-chevron-down text-xs ml-1\"></i></button><div x-show=\"open\" @click.away=\"open = false\" x-cloak class=\"absolute right-0 mt-2 w-56 bg-dark-800 border border-dark-600 rounded-lg shadow-xl z-50\"><div class=\"py-1\"><button type=\"button\" @click=\"insertSnippet('service'); open = false\" class=\"w-full px-4 py-2 text-left text-sm text-gray-300 hover:bg-dark-700\"><i class=\"fas fa-cube mr-2 text-blue-400\"></i>Service</button> <button type=\"button\" @click=\"insertSnippet('volume'); open = false\" class=\"w-full px-4 py-2 text-left text-sm text-gray-300 hover:bg-dark-700\"><i class=\"fas fa-hdd mr-2 text-green-400\"></i>Volume</button> <button type=\"button\" @click=\"insertSnippet('network'); open = false\" class=\"w-full px-4 py-2 text-left text-sm text-gray-300 hover:bg-dark-700\"><i class=\"fas fa-network-wired mr-2 text-purple-400\"></i>Network</button> <button type=\"button\" @click=\"insertSnippet('healthcheck'); open = false\" class=\"w-full px-4 py-2 text-left text-sm text-gray-300 hover:bg-dark-700\"><i class=\"fas fa-heartbeat mr-2 text-red-400\"></i>Healthcheck</button> <button type=\"button\" @click=\"insertSnippet('environment'); open = false\" class=\"w-full px-4 py-2 text-left text-sm text-gray-300 hover:bg-dark-700\"><i class=\"fas fa-key mr-2 text-yellow-400\"></i>Environment</button><div class=\"border-t border-dark-600 my-1\"></div><button type=\"button\" @click=\"insertSnippet('nginx'); open = false\" class=\"w-full px-4 py-2 text-left text-sm text-gray-300 hover:bg-dark-700\"><i class=\"fas fa-server mr-2 text-emerald-400\"></i>Nginx Template</button> <button type=\"button\" @click=\"insertSnippet('postgres'); open = false\" class=\"w-full px-4 py-2 text-left text-sm text-gray-300 hover:bg-dark-700\"><i class=\"fas fa-database mr-2 text-blue-400\"></i>PostgreSQL Template</button></div></div></div><!-- Validation status --><span x-show=\"validationStatus === 'valid'\" class=\"text-xs text-green-400\"><i class=\"fas fa-check-circle mr-1\"></i>Valid</span> <span x-show=\"validationStatus === 'invalid'\" class=\"text-xs text-red-400\"><i class=\"fas fa-exclamation-circle mr-1\"></i>Invalid YAML</span></div></div><!-- Editor with line numbers --><div class=\"compose-editor-wrap\"><div class=\"compose-line-numbers\" x-ref=\"lineNumbers\" aria-hidden=\"true\"></div><textarea x-ref=\"editor\" x-model=\"content\" @input=\"onInput()\" @keydown.tab.prevent=\"handleTab($event)\" @keydown.enter.prevent=\"handleEnter($event)\" @scroll=\"syncScroll()\" class=\"compose-textarea\" spellcheck=\"false\" autocapitalize=\"off\" autocomplete=\"off\" autocorrect=\"off\" placeholder=\"Paste your docker-compose.yml content here...\"></textarea></div></div><div class=\"flex justify-end gap-3\"><a href=\"/stacks\" class=\"btn-secondary\">Cancel</a> <button type=\"submit\" class=\"btn-primary\" :disabled=\"deploying\"><template x-if=\"deploying\"><span><i class=\"fas fa-spinner fa-spin mr-2\"></i>Deploying...</span></template><template x-if=\"!deploying\"><span><i class=\"fas fa-rocket mr-2\"></i>Deploy Stack</span></template></button></div></form><!-- Deploy Log Modal --><div x-show=\"showLogModal\" x-cloak class=\"fixed inset-0 z-50 flex items-center justify-center p-4\" @keydown.escape.window=\"if(deployFinished) showLogModal = false\"><!-- Backdrop --><div class=\"absolute inset-0 bg-black/70 backdrop-blur-sm\"></div><!-- Modal panel --><div class=\"relative w-full max-w-3xl bg-dark-800 rounded-2xl border border-dark-600 shadow-2xl flex flex-col\" style=\"max-height: 80vh;\"><!-- Header --><div class=\"flex items-center justify-between px-5 py-4 border-b border-dark-600\"><div class=\"flex items-center gap-3\"><div x-show=\"!deployFinished\" class=\"w-2 h-2 rounded-full bg-primary-400 animate-pulse\"></div><div x-show=\"deployFinished && deploySuccess\" class=\"w-2 h-2 rounded-full bg-green-400\"></div><div x-show=\"deployFinished && !deploySuccess\" class=\"w-2 h-2 rounded-full bg-red-400\"></div><h2 class=\"text-base font-semibold text-white font-display\"><span x-show=\"!deployFinished\">Deploying stack...</span> <span x-show=\"deployFinished && deploySuccess\" class=\"text-green-400\">Deployment successful</span> <span x-show=\"deployFinished && !deploySuccess\" class=\"text-red-400\">Deployment failed</span></h2></div><button x-show=\"deployFinished\" @click=\"showLogModal = false\" class=\"p-1.5 text-gray-400 hover:text-white hover:bg-dark-700 rounded-lg transition-colors\"><i class=\"fas fa-times\"></i></button></div><!-- Log output --><div id=\"deploy-log-output\" class=\"flex-1 overflow-y-auto p-4 font-mono text-xs text-gray-300 space-y-0.5 bg-[#0d1117]\" style=\"min-height: 300px;\"><template x-if=\"logLines.length === 0 && !deployFinished\"><p class=\"text-gray-500 italic\">Waiting for output...</p></template><template x-for=\"(line, idx) in logLines\" :key=\"idx\"><div class=\"leading-5 whitespace-pre-wrap break-all\" x-text=\"line\"></div></template></div><!-- Footer --><div class=\"px-5 py-3 border-t border-dark-600 flex items-center justify-between gap-3\"><div class=\"flex items-center gap-2 text-sm\"><span x-show=\"!deployFinished\" class=\"text-gray-400\"><i class=\"fas fa-spinner fa-spin mr-1.5\"></i>Running docker compose...</span> <span x-show=\"deployFinished && deploySuccess\" class=\"text-green-400\"><i class=\"fas fa-check-circle mr-1.5\"></i>All services started successfully.</span> <span x-show=\"deployFinished && !deploySuccess\" class=\"text-red-400\"><i class=\"fas fa-exclamation-circle mr-1.5\"></i><span x-text=\"deployError\"></span></span></div><div class=\"flex gap-2 flex-shrink-0\"><button x-show=\"deployFinished && !deploySuccess\" @click=\"showLogModal = false\" class=\"btn-secondary text-sm\">Close</button> <a x-show=\"deployFinished && deploySuccess\" :href=\"deployRedirect\" class=\"btn-primary text-sm\"><i class=\"fas fa-arrow-right mr-1.5\"></i>Go to Stack</a></div></div></div></div></div><style>\n\t\t.compose-editor-wrap {\n\t\t\tdisplay: flex;\n\t\t\theight: 500px;\n\t\t\tbackground: #0d1117;\n\t\t\toverflow: hidden;\n\t\t}\n\t\t.compose-line-numbers {\n\t\t\twidth: 48px;\n\t\t\tmin-width: 48px;\n\t\t\tpadding: 12px 8px 12px 0;\n\t\t\ttext-align: right;\n\t\t\tfont-family: 'IBM Plex Mono', 'JetBrains Mono', 'Fira Code', monospace;\n\t\t\tfont-size: 14px;\n\t\t\tline-height: 1.6;\n\t\t\tcolor: #484f58;\n\t\t\tbackground: #0d1117;\n\t\t\tborder-right: 1px solid #21262d;\n\t\t\toverflow: hidden;\n\t\t\tuser-select: none;\n\t\t\twhite-space: pre;\n\t\t}\n\t\t.compose-textarea {\n\t\t\tflex: 1;\n\t\t\tpadding: 12px 16px;\n\t\t\tbackground: #0d1117;\n\t\t\tcolor: #e6edf3;\n\t\t\tfont-family: 'IBM Plex Mono', 'JetBrains Mono', 'Fira Code', monospace;\n\t\t\tfont-size: 14px;\n\t\t\tline-height: 1.6;\n\t\t\tborder: 0;\n\t\t\toutline: none;\n\t\t\tresize: none;\n\t\t\ttab-size: 2;\n\t\t\twhite-space: pre;\n\t\t\toverflow-wrap: normal;\n\t\t\toverflow-x: auto;\n\t\t\toverflow-y: auto;\n\t\t}\n\t\t.compose-textarea:focus {\n\t\t\tbox-shadow: none;\n\t\t\tring: 0;\n\t\t}\n\t\t.compose-textarea::placeholder {\n\t\t\tcolor: #484f58;\n\t\t}\n\t\t.compose-textarea::selection {\n\t\t\tbackground: rgba(255, 107, 53, 0.3);\n\t\t}\n\t\t</style> <script>\n\t\tfunction composeEditor() {\n\t\t\tconst defaultContent = `services:\n  # Define your services here\n  app:\n    image: nginx:alpine\n    ports:\n      - \"80:80\"\n    restart: unless-stopped\n\n# volumes:\n#   data:\n\n# networks:\n#   default:\n`;\n\n\t\t\treturn {\n\t\t\t\tcontent: defaultContent,\n\t\t\t\tvalidationStatus: 'unknown',\n\t\t\t\tstackName: '',\n\t\t\t\tdeploying: false,\n\t\t\t\tdeployError: '',\n\t\t\t\tshowLogModal: false,\n\t\t\t\tlogLines: [],\n\t\t\t\tdeployFinished: false,\n\t\t\t\tdeploySuccess: false,\n\t\t\t\tdeployRedirect: '',\n\n\t\t\t\tinit() {\n\t\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t\t\tthis.updateLineNumbers();\n\t\t\t\t\t\tthis.validateYaml();\n\t\t\t\t\t});\n\t\t\t\t},\n\n\t\t\t\tupdateLineNumbers() {\n\t\t\t\t\tconst lines = this.content.split('\\n').length;\n\t\t\t\t\tconst nums = [];\n\t\t\t\t\tfor (let i = 1; i <= lines; i++) {\n\t\t\t\t\t\tnums.push(i);\n\t\t\t\t\t}\n\t\t\t\t\tthis.$refs.lineNumbers.textContent = nums.join('\\n');\n\t\t\t\t},\n\n\t\t\t\tsyncScroll() {\n\t\t\t\t\tthis.$refs.lineNumbers.style.transform = `translateY(-${this.$refs.editor.scrollTop}px)`;\n\t\t\t\t},\n\n\t\t\t\tonInput() {\n\t\t\t\t\tthis.updateLineNumbers();\n\t\t\t\t\tthis.validateYaml();\n\t\t\t\t},\n\n\t\t\t\thandleTab(e) {\n\t\t\t\t\tconst ta = this.$refs.editor;\n\t\t\t\t\tconst start = ta.selectionStart;\n\t\t\t\t\tconst end = ta.selectionEnd;\n\n\t\t\t\t\tif (start === end) {\n\t\t\t\t\t\t// No selection: insert 2 spaces\n\t\t\t\t\t\tthis.content = this.content.substring(0, start) + '  ' + this.content.substring(end);\n\t\t\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t\t\t\tta.selectionStart = ta.selectionEnd = start + 2;\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Selection: indent/unindent lines\n\t\t\t\t\t\tconst before = this.content.substring(0, start);\n\t\t\t\t\t\tconst selected = this.content.substring(start, end);\n\t\t\t\t\t\tconst after = this.content.substring(end);\n\n\t\t\t\t\t\tconst lineStart = before.lastIndexOf('\\n') + 1;\n\t\t\t\t\t\tconst block = this.content.substring(lineStart, end);\n\n\t\t\t\t\t\tif (e.shiftKey) {\n\t\t\t\t\t\t\t// Unindent\n\t\t\t\t\t\t\tconst unindented = block.replace(/^  /gm, '');\n\t\t\t\t\t\t\tconst diff = block.length - unindented.length;\n\t\t\t\t\t\t\tthis.content = this.content.substring(0, lineStart) + unindented + after;\n\t\t\t\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t\t\t\t\tta.selectionStart = lineStart;\n\t\t\t\t\t\t\t\tta.selectionEnd = lineStart + unindented.length;\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// Indent\n\t\t\t\t\t\t\tconst indented = block.replace(/^/gm, '  ');\n\t\t\t\t\t\t\tconst diff = indented.length - block.length;\n\t\t\t\t\t\t\tthis.content = this.content.substring(0, lineStart) + indented + after;\n\t\t\t\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t\t\t\t\tta.selectionStart = lineStart;\n\t\t\t\t\t\t\t\tta.selectionEnd = lineStart + indented.length;\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tthis.updateLineNumbers();\n\t\t\t\t\tthis.validateYaml();\n\t\t\t\t},\n\n\t\t\t\thandleEnter(e) {\n\t\t\t\t\tconst ta = this.$refs.editor;\n\t\t\t\t\tconst start = ta.selectionStart;\n\t\t\t\t\tconst textBefore = this.content.substring(0, start);\n\t\t\t\t\tconst currentLine = textBefore.substring(textBefore.lastIndexOf('\\n') + 1);\n\n\t\t\t\t\t// Match indentation of current line\n\t\t\t\t\tconst indent = currentLine.match(/^(\\s*)/)[1];\n\n\t\t\t\t\t// Add extra indent if line ends with ':'\n\t\t\t\t\tconst trimmed = currentLine.trimEnd();\n\t\t\t\t\tconst extra = trimmed.endsWith(':') ? '  ' : '';\n\n\t\t\t\t\tconst insertion = '\\n' + indent + extra;\n\t\t\t\t\tthis.content = this.content.substring(0, start) + insertion + this.content.substring(ta.selectionEnd);\n\t\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t\t\tta.selectionStart = ta.selectionEnd = start + insertion.length;\n\t\t\t\t\t});\n\t\t\t\t\tthis.updateLineNumbers();\n\t\t\t\t},\n\n\t\t\t\tvalidateYaml() {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tconst lines = this.content.split('\\n');\n\t\t\t\t\t\tlet valid = this.content.includes('services:');\n\n\t\t\t\t\t\tfor (const line of lines) {\n\t\t\t\t\t\t\tif (line.trim() && !line.startsWith('#')) {\n\t\t\t\t\t\t\t\tconst spaces = line.search(/\\S/);\n\t\t\t\t\t\t\t\tif (spaces > 0 && spaces % 2 !== 0) {\n\t\t\t\t\t\t\t\t\tvalid = false;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tthis.validationStatus = valid ? 'valid' : 'invalid';\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tthis.validationStatus = 'invalid';\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\tdeployStack() {\n\t\t\t\t\tthis.deployError = '';\n\n\t\t\t\t\tconst name = this.stackName.trim();\n\t\t\t\t\tif (!name) {\n\t\t\t\t\t\tthis.deployError = 'Stack name is required.';\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst compose = this.content.trim();\n\t\t\t\t\tif (!compose) {\n\t\t\t\t\t\tthis.deployError = 'Please enter Docker Compose content.';\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.deploying = true;\n\t\t\t\t\tthis.showLogModal = true;\n\t\t\t\t\tthis.logLines = [];\n\t\t\t\t\tthis.deployFinished = false;\n\t\t\t\t\tthis.deploySuccess = false;\n\t\t\t\t\tthis.deployRedirect = '';\n\n\t\t\t\t\tconst formData = new FormData();\n\t\t\t\t\tformData.append('csrf_token', this.$refs.csrfToken.value);\n\t\t\t\t\tformData.append('name', name);\n\t\t\t\t\tformData.append('compose', compose);\n\t\t\t\t\tif (document.getElementById('pull').checked) {\n\t\t\t\t\t\tformData.append('pull', 'on');\n\t\t\t\t\t}\n\n\t\t\t\t\tfetch('/stacks/deploy', {\n\t\t\t\t\t\tmethod: 'POST',\n\t\t\t\t\t\theaders: { 'X-Deploy-Stream': '1' },\n\t\t\t\t\t\tbody: formData,\n\t\t\t\t\t})\n\t\t\t\t\t.then(resp => {\n\t\t\t\t\t\tconst reader = resp.body.getReader();\n\t\t\t\t\t\tconst decoder = new TextDecoder();\n\t\t\t\t\t\tlet buf = '';\n\t\t\t\t\t\tconst self = this;\n\t\t\t\t\t\tfunction pump() {\n\t\t\t\t\t\t\treturn reader.read().then(({ done, value }) => {\n\t\t\t\t\t\t\t\tif (done) return;\n\t\t\t\t\t\t\t\tbuf += decoder.decode(value, { stream: true });\n\t\t\t\t\t\t\t\tconst parts = buf.split('\n\n');\n\t\t\t\t\t\t\t\tbuf = parts.pop();\n\t\t\t\t\t\t\t\tparts.forEach(block => {\n\t\t\t\t\t\t\t\t\tconst lines = block.split('\n');\n\t\t\t\t\t\t\t\t\tlet evt = '', data = '';\n\t\t\t\t\t\t\t\t\tlines.forEach(l => {\n\t\t\t\t\t\t\t\t\t\tif (l.startsWith('event: ')) evt = l.slice(7);\n\t\t\t\t\t\t\t\t\t\telse if (l.startsWith('data: ')) data = l.slice(6);\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tif (evt === 'log') {\n\t\t\t\t\t\t\t\t\t\tself.logLines.push(data);\n\t\t\t\t\t\t\t\t\t\tself.$nextTick(() => {\n\t\t\t\t\t\t\t\t\t\t\tconst el = document.getElementById('deploy-log-output');\n\t\t\t\t\t\t\t\t\t\t\tif (el) el.scrollTop = el.scrollHeight;\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t} else if (evt === 'done') {\n\t\t\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\t\t\tconst res = JSON.parse(data);\n\t\t\t\t\t\t\t\t\t\t\tself.deployFinished = true;\n\t\t\t\t\t\t\t\t\t\t\tself.deploySuccess = res.ok;\n\t\t\t\t\t\t\t\t\t\t\tif (res.ok) self.deployRedirect = res.redirect;\n\t\t\t\t\t\t\t\t\t\t\telse self.deployError = res.error || 'Deploy failed';\n\t\t\t\t\t\t\t\t\t\t} catch(_) {}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\treturn pump();\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn pump();\n\t\t\t\t\t})\n\t\t\t\t\t.catch(err => {\n\t\t\t\t\t\tthis.deployError = err.message;\n\t\t\t\t\t\tthis.deployFinished = true;\n\t\t\t\t\t\tthis.deploySuccess = false;\n\t\t\t\t\t})\n\t\t\t\t\t.finally(() => {\n\t\t\t\t\t\tthis.deploying = false;\n\t\t\t\t\t});\n\t\t\t\t},\n\n\t\t\t\tinsertSnippet(type) {\n\t\t\t\t\tconst snippets = {\n\t\t\t\t\t\tservice: `  myservice:\\n    image: nginx:alpine\\n    ports:\\n      - \"8080:80\"\\n    volumes:\\n      - ./data:/data\\n    restart: unless-stopped\\n`,\n\t\t\t\t\t\tvolume: `  myvolume:\\n    driver: local\\n`,\n\t\t\t\t\t\tnetwork: `  mynetwork:\\n    driver: bridge\\n`,\n\t\t\t\t\t\thealthcheck: `    healthcheck:\\n      test: [\"CMD\", \"curl\", \"-f\", \"http://localhost/\"]\\n      interval: 30s\\n      timeout: 10s\\n      retries: 3\\n      start_period: 40s\\n`,\n\t\t\t\t\t\tenvironment: `    environment:\\n      - NODE_ENV=production\\n      - DATABASE_URL=postgres://user:pass@db:5432/mydb\\n`,\n\t\t\t\t\t\tnginx: `services:\\n  nginx:\\n    image: nginx:alpine\\n    ports:\\n      - \"80:80\"\\n      - \"443:443\"\\n    volumes:\\n      - ./nginx.conf:/etc/nginx/nginx.conf:ro\\n      - ./html:/usr/share/nginx/html:ro\\n    restart: unless-stopped\\n    healthcheck:\\n      test: [\"CMD\", \"nginx\", \"-t\"]\\n      interval: 30s\\n      timeout: 10s\\n      retries: 3\\n`,\n\t\t\t\t\t\tpostgres: `services:\\n  db:\\n    image: postgres:16-alpine\\n    environment:\\n      POSTGRES_USER: myuser\\n      POSTGRES_PASSWORD: mypassword\\n      POSTGRES_DB: mydb\\n    volumes:\\n      - postgres_data:/var/lib/postgresql/data\\n    ports:\\n      - \"5432:5432\"\\n    restart: unless-stopped\\n    healthcheck:\\n      test: [\"CMD-SHELL\", \"pg_isready -U myuser -d mydb\"]\\n      interval: 10s\\n      timeout: 5s\\n      retries: 5\\n\\nvolumes:\\n  postgres_data:\\n`,\n\t\t\t\t\t};\n\n\t\t\t\t\tconst snippet = snippets[type];\n\t\t\t\t\tif (!snippet) return;\n\n\t\t\t\t\tif (type === 'nginx' || type === 'postgres') {\n\t\t\t\t\t\tthis.content = snippet;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst ta = this.$refs.editor;\n\t\t\t\t\t\tconst pos = ta.selectionStart;\n\t\t\t\t\t\tthis.content = this.content.substring(0, pos) + snippet + this.content.substring(pos);\n\t\t\t\t\t\tthis.$nextTick(() => {\n\t\t\t\t\t\t\tta.selectionStart = ta.selectionEnd = pos + snippet.length;\n\t\t\t\t\t\t\tta.focus();\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tthis.updateLineNumbers();\n\t\t\t\t\tthis.validateYaml();\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t\t</script>")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			return nil
		})
		templ_7745c5c3_Err = layouts.Base(data.PageData).Render(templ.WithChildren(ctx, templ_7745c5c3_Var2), templ_7745c5c3_Buffer)
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		return nil
	})
}

var _ = templruntime.GeneratedTemplate
