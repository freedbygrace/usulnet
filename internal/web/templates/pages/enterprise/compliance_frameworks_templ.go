// Code generated by templ - DO NOT EDIT.

// templ: version: v0.3.977
// SPDX-License-Identifier: AGPL-3.0-or-later

// Copyright (c) 2024-2026 usulnet contributors

// https://github.com/fr4nsys/usulnet

package enterprise

//lint:file-ignore SA4006 This context is only used if a nested component is present.

import "github.com/a-h/templ"
import templruntime "github.com/a-h/templ/runtime"

import "github.com/fr4nsys/usulnet/internal/web/templates/layouts"

// ComplianceFrameworksData holds data for the compliance frameworks page.
type ComplianceFrameworksData struct {
	PageData layouts.PageData
}

func ComplianceFrameworks(data ComplianceFrameworksData) templ.Component {
	return templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
		templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
		if templ_7745c5c3_CtxErr := ctx.Err(); templ_7745c5c3_CtxErr != nil {
			return templ_7745c5c3_CtxErr
		}
		templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
		if !templ_7745c5c3_IsBuffer {
			defer func() {
				templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
				if templ_7745c5c3_Err == nil {
					templ_7745c5c3_Err = templ_7745c5c3_BufErr
				}
			}()
		}
		ctx = templ.InitializeContext(ctx)
		templ_7745c5c3_Var1 := templ.GetChildren(ctx)
		if templ_7745c5c3_Var1 == nil {
			templ_7745c5c3_Var1 = templ.NopComponent
		}
		ctx = templ.ClearChildren(ctx)
		templ_7745c5c3_Var2 := templruntime.GeneratedTemplate(func(templ_7745c5c3_Input templruntime.GeneratedComponentInput) (templ_7745c5c3_Err error) {
			templ_7745c5c3_W, ctx := templ_7745c5c3_Input.Writer, templ_7745c5c3_Input.Context
			templ_7745c5c3_Buffer, templ_7745c5c3_IsBuffer := templruntime.GetBuffer(templ_7745c5c3_W)
			if !templ_7745c5c3_IsBuffer {
				defer func() {
					templ_7745c5c3_BufErr := templruntime.ReleaseBuffer(templ_7745c5c3_Buffer)
					if templ_7745c5c3_Err == nil {
						templ_7745c5c3_Err = templ_7745c5c3_BufErr
					}
				}()
			}
			ctx = templ.InitializeContext(ctx)
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 1, "<div x-data=\"")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			var templ_7745c5c3_Var3 string
			templ_7745c5c3_Var3, templ_7745c5c3_Err = templ.JoinStringErrs(complianceAlpineInit(data.PageData.CSRFToken))
			if templ_7745c5c3_Err != nil {
				return templ.Error{Err: templ_7745c5c3_Err, FileName: `internal/web/templates/pages/enterprise/compliance_frameworks.templ`, Line: 17, Col: 57}
			}
			_, templ_7745c5c3_Err = templ_7745c5c3_Buffer.WriteString(templ.EscapeString(templ_7745c5c3_Var3))
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			templ_7745c5c3_Err = templruntime.WriteString(templ_7745c5c3_Buffer, 2, "\" x-init=\"init()\" class=\"space-y-6\"><!-- Header --><div class=\"flex items-center justify-between\"><div><h1 class=\"text-2xl font-display font-bold text-white\">Compliance Frameworks</h1><p class=\"text-gray-400 mt-1\">SOC 2, HIPAA, PCI-DSS compliance management and assessment tracking</p></div><div class=\"flex items-center gap-2\"><button @click=\"seedFrameworks()\" :disabled=\"seeding\" class=\"btn-secondary flex items-center gap-2\"><i class=\"fas fa-database\" :class=\"seeding && 'animate-spin'\"></i> <span x-text=\"seeding ? 'Seeding...' : 'Seed Default Frameworks'\"></span></button></div></div><!-- Loading State --><div x-show=\"loading\" class=\"card p-12 text-center\"><i class=\"fas fa-spinner fa-spin text-2xl text-primary-400 mb-4\"></i><p class=\"text-gray-400\">Loading compliance frameworks...</p></div><!-- Error State --><div x-show=\"error && !loading\" x-cloak class=\"card border-l-4 border-l-red-500 p-4\"><div class=\"flex items-center gap-3\"><i class=\"fas fa-exclamation-circle text-red-400\"></i><div><h3 class=\"text-sm font-medium text-red-400\">Failed to load frameworks</h3><p class=\"text-xs text-gray-400 mt-0.5\" x-text=\"error\"></p></div><button @click=\"fetchFrameworks()\" class=\"ml-auto btn-secondary text-sm\">Retry</button></div></div><!-- Main Content --><div x-show=\"!loading && !error\" x-cloak class=\"space-y-6\"><!-- Tabs --><div class=\"flex gap-1 border-b border-dark-600\"><button @click=\"tab = 'frameworks'\" :class=\"tab === 'frameworks' ? 'border-primary-500 text-white' : 'border-transparent text-gray-400 hover:text-gray-300'\" class=\"px-4 py-2 text-sm font-medium border-b-2 -mb-px transition-colors\"><i class=\"fas fa-layer-group mr-2\"></i>Frameworks <span class=\"ml-1 px-1.5 py-0.5 text-xs bg-dark-600 rounded\" x-text=\"frameworks.length\"></span></button> <button @click=\"tab = 'assessments'; if (allAssessments.length === 0 && !loadingAssessments) fetchAllAssessments()\" :class=\"tab === 'assessments' ? 'border-primary-500 text-white' : 'border-transparent text-gray-400 hover:text-gray-300'\" class=\"px-4 py-2 text-sm font-medium border-b-2 -mb-px transition-colors\"><i class=\"fas fa-clipboard-check mr-2\"></i>Assessments <span class=\"ml-1 px-1.5 py-0.5 text-xs bg-dark-600 rounded\" x-text=\"allAssessments.length\"></span></button> <button @click=\"tab = 'evidence'; if (evidenceList.length === 0 && selectedAssessmentForEvidence) fetchEvidence(selectedAssessmentForEvidence)\" :class=\"tab === 'evidence' ? 'border-primary-500 text-white' : 'border-transparent text-gray-400 hover:text-gray-300'\" class=\"px-4 py-2 text-sm font-medium border-b-2 -mb-px transition-colors\"><i class=\"fas fa-file-alt mr-2\"></i>Evidence <span class=\"ml-1 px-1.5 py-0.5 text-xs bg-dark-600 rounded\" x-text=\"evidenceList.length\"></span></button></div><!-- ==================== FRAMEWORKS TAB ==================== --><div x-show=\"tab === 'frameworks'\" x-cloak class=\"space-y-6\"><!-- Framework Cards --><div x-show=\"frameworks.length > 0\" class=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4\"><template x-for=\"fw in frameworks\" :key=\"fw.id\"><div class=\"card p-5 hover:border-primary-500/50 transition-colors\"><div class=\"flex items-start justify-between mb-4\"><div class=\"flex items-center gap-3\"><div class=\"w-10 h-10 rounded-lg flex items-center justify-center\" :class=\"frameworkIconBg(fw.name)\"><i class=\"fas\" :class=\"frameworkIcon(fw.name)\"></i></div><div><h3 class=\"font-medium text-white\" x-text=\"fw.display_name || fw.name\"></h3><p class=\"text-xs text-gray-500\" x-text=\"'v' + (fw.version || '1.0')\"></p></div></div><span class=\"px-2 py-0.5 text-xs rounded\" :class=\"fw.is_enabled ? 'bg-green-500/20 text-green-400' : 'bg-gray-500/20 text-gray-400'\" x-text=\"fw.is_enabled ? 'Enabled' : 'Disabled'\"></span></div><p class=\"text-sm text-gray-400 mb-4 line-clamp-2\" x-text=\"fw.description || 'No description'\"></p><!-- Compliance Score Gauge --><div class=\"mb-4\"><div class=\"flex items-center justify-between mb-1\"><span class=\"text-xs text-gray-400\">Compliance Score</span> <span class=\"text-sm font-bold\" :class=\"scoreColor(fw._status ? fw._status.compliance_score : null)\" x-text=\"fw._status && fw._status.compliance_score != null ? Math.round(fw._status.compliance_score) + '%' : '--'\"></span></div><div class=\"w-full h-2 bg-dark-700 rounded-full overflow-hidden\"><div class=\"h-full rounded-full transition-all duration-500\" :class=\"scoreBarColor(fw._status ? fw._status.compliance_score : null)\" :style=\"'width: ' + (fw._status && fw._status.compliance_score != null ? fw._status.compliance_score : 0) + '%'\"></div></div></div><!-- Control Counts --><div x-show=\"fw._status\" class=\"grid grid-cols-4 gap-2 mb-4 text-center\"><div><p class=\"text-sm font-bold text-green-400\" x-text=\"fw._status ? fw._status.implemented || 0 : 0\"></p><p class=\"text-[10px] text-gray-500\">Done</p></div><div><p class=\"text-sm font-bold text-yellow-400\" x-text=\"fw._status ? fw._status.in_progress || 0 : 0\"></p><p class=\"text-[10px] text-gray-500\">In Prog</p></div><div><p class=\"text-sm font-bold text-gray-400\" x-text=\"fw._status ? fw._status.not_started || 0 : 0\"></p><p class=\"text-[10px] text-gray-500\">Not Started</p></div><div><p class=\"text-sm font-bold text-blue-400\" x-text=\"fw._status ? fw._status.not_applicable || 0 : 0\"></p><p class=\"text-[10px] text-gray-500\">N/A</p></div></div><!-- Actions --><div class=\"flex items-center gap-2 pt-3 border-t border-dark-700\"><button @click=\"openFrameworkDetail(fw)\" class=\"text-sm text-primary-400 hover:text-primary-300 transition-colors flex items-center gap-1 flex-1\"><i class=\"fas fa-list text-xs\"></i> Controls</button> <button @click=\"runAssessment(fw)\" :disabled=\"fw._assessing\" class=\"text-sm text-green-400 hover:text-green-300 transition-colors flex items-center gap-1 flex-1\"><i class=\"fas fa-play text-xs\" :class=\"fw._assessing && 'animate-spin'\"></i> <span x-text=\"fw._assessing ? 'Running...' : 'Assess'\"></span></button> <button @click=\"openAssessmentHistory(fw)\" class=\"text-sm text-gray-400 hover:text-gray-300 transition-colors flex items-center gap-1 flex-1\"><i class=\"fas fa-history text-xs\"></i> History</button></div></div></template></div><!-- Empty State --><div x-show=\"frameworks.length === 0\" x-cloak class=\"card p-12 text-center\"><i class=\"fas fa-balance-scale text-4xl text-gray-400 mb-4\"></i><h3 class=\"text-lg font-medium text-white mb-2\">No Compliance Frameworks</h3><p class=\"text-gray-400 mb-4\">Seed default frameworks (SOC 2, HIPAA, PCI-DSS) to start compliance tracking</p><button @click=\"seedFrameworks()\" :disabled=\"seeding\" class=\"btn-primary\"><i class=\"fas fa-database mr-2\"></i>Seed Default Frameworks</button></div></div><!-- ==================== ASSESSMENTS TAB ==================== --><div x-show=\"tab === 'assessments'\" x-cloak class=\"space-y-4\"><!-- Assessments Loading --><div x-show=\"loadingAssessments\" class=\"card p-8 text-center\"><i class=\"fas fa-spinner fa-spin text-xl text-gray-400 mb-2\"></i><p class=\"text-sm text-gray-400\">Loading assessments...</p></div><!-- Assessments Table --><div x-show=\"!loadingAssessments && allAssessments.length > 0\" x-cloak class=\"card overflow-hidden\"><table class=\"w-full\"><thead><tr class=\"border-b border-dark-600\"><th class=\"text-left text-xs font-medium text-gray-400 uppercase px-4 py-3\">Assessment</th><th class=\"text-left text-xs font-medium text-gray-400 uppercase px-4 py-3\">Framework</th><th class=\"text-left text-xs font-medium text-gray-400 uppercase px-4 py-3\">Status</th><th class=\"text-left text-xs font-medium text-gray-400 uppercase px-4 py-3\">Score</th><th class=\"text-left text-xs font-medium text-gray-400 uppercase px-4 py-3\">Controls</th><th class=\"text-left text-xs font-medium text-gray-400 uppercase px-4 py-3\">Date</th><th class=\"text-left text-xs font-medium text-gray-400 uppercase px-4 py-3\">Actions</th></tr></thead> <tbody class=\"divide-y divide-dark-700\"><template x-for=\"a in allAssessments\" :key=\"a.id\"><tr class=\"hover:bg-dark-700/50\"><td class=\"px-4 py-3\"><div class=\"font-medium text-white\" x-text=\"a.name || ('Assessment #' + a.id.substring(0, 8))\"></div></td><td class=\"px-4 py-3\"><span class=\"text-sm text-gray-300\" x-text=\"frameworkNameById(a.framework_id)\"></span></td><td class=\"px-4 py-3\"><span class=\"px-2 py-0.5 text-xs rounded\" :class=\"assessmentStatusClass(a.status)\" x-text=\"a.status\"></span></td><td class=\"px-4 py-3\"><span class=\"text-sm font-bold\" :class=\"scoreColor(a.score)\" x-text=\"a.score != null ? Math.round(a.score) + '%' : '--'\"></span></td><td class=\"px-4 py-3 text-sm text-gray-400\"><span class=\"text-green-400\" x-text=\"a.passed_controls || 0\"></span> <span class=\"text-gray-600\">/</span> <span class=\"text-red-400\" x-text=\"a.failed_controls || 0\"></span> <span class=\"text-gray-600\">/</span> <span x-text=\"a.total_controls || 0\"></span></td><td class=\"px-4 py-3 text-sm text-gray-400 whitespace-nowrap\" x-text=\"formatTimestamp(a.completed_at || a.started_at)\"></td><td class=\"px-4 py-3\"><div class=\"flex items-center gap-1\"><button @click=\"viewAssessmentDetail(a)\" class=\"p-1.5 text-gray-400 hover:text-primary-400 transition-colors\" title=\"View details\"><i class=\"fas fa-eye text-sm\"></i></button> <button @click=\"downloadReport(a.id, 'json')\" class=\"p-1.5 text-gray-400 hover:text-blue-400 transition-colors\" title=\"Download JSON report\"><i class=\"fas fa-file-code text-sm\"></i></button> <button @click=\"downloadReport(a.id, 'html')\" class=\"p-1.5 text-gray-400 hover:text-green-400 transition-colors\" title=\"Download HTML report\"><i class=\"fas fa-file-alt text-sm\"></i></button> <button @click=\"selectedAssessmentForEvidence = a.id; tab = 'evidence'; fetchEvidence(a.id)\" class=\"p-1.5 text-gray-400 hover:text-yellow-400 transition-colors\" title=\"View evidence\"><i class=\"fas fa-folder-open text-sm\"></i></button></div></td></tr></template></tbody></table></div><!-- Assessments Empty State --><div x-show=\"!loadingAssessments && allAssessments.length === 0\" x-cloak class=\"card p-12 text-center\"><i class=\"fas fa-clipboard-check text-4xl text-gray-400 mb-4\"></i><h3 class=\"text-lg font-medium text-white mb-2\">No Assessments</h3><p class=\"text-gray-400\">Run an assessment from the Frameworks tab to evaluate your compliance posture</p></div></div><!-- ==================== EVIDENCE TAB ==================== --><div x-show=\"tab === 'evidence'\" x-cloak class=\"space-y-4\"><!-- Assessment Selector --><div class=\"flex items-center gap-3\"><div><select x-model=\"selectedAssessmentForEvidence\" @change=\"fetchEvidence(selectedAssessmentForEvidence)\" class=\"input text-sm\"><option value=\"\">Select an assessment...</option><template x-for=\"a in allAssessments\" :key=\"a.id\"><option :value=\"a.id\" x-text=\"(a.name || 'Assessment') + ' (' + formatTimestamp(a.completed_at || a.started_at) + ')'\"></option></template></select></div><button x-show=\"selectedAssessmentForEvidence\" @click=\"showAddEvidenceModal = true\" class=\"btn-primary flex items-center gap-2 text-sm\"><i class=\"fas fa-plus\"></i> Add Evidence</button></div><!-- Evidence Loading --><div x-show=\"loadingEvidence\" class=\"card p-8 text-center\"><i class=\"fas fa-spinner fa-spin text-xl text-gray-400 mb-2\"></i><p class=\"text-sm text-gray-400\">Loading evidence...</p></div><!-- Evidence Table --><div x-show=\"!loadingEvidence && evidenceList.length > 0\" x-cloak class=\"card overflow-hidden\"><table class=\"w-full\"><thead><tr class=\"border-b border-dark-600\"><th class=\"text-left text-xs font-medium text-gray-400 uppercase px-4 py-3\">Title</th><th class=\"text-left text-xs font-medium text-gray-400 uppercase px-4 py-3\">Control</th><th class=\"text-left text-xs font-medium text-gray-400 uppercase px-4 py-3\">Type</th><th class=\"text-left text-xs font-medium text-gray-400 uppercase px-4 py-3\">Status</th><th class=\"text-left text-xs font-medium text-gray-400 uppercase px-4 py-3\">Collected</th></tr></thead> <tbody class=\"divide-y divide-dark-700\"><template x-for=\"ev in evidenceList\" :key=\"ev.id\"><tr class=\"hover:bg-dark-700/50\"><td class=\"px-4 py-3\"><div class=\"font-medium text-white\" x-text=\"ev.title\"></div><div class=\"text-xs text-gray-500 mt-0.5 max-w-[300px] truncate\" x-text=\"ev.description\"></div></td><td class=\"px-4 py-3 text-sm text-gray-300 font-mono\" x-text=\"ev.control_id || '-'\"></td><td class=\"px-4 py-3\"><span class=\"px-2 py-0.5 text-xs bg-dark-600 text-gray-300 rounded\" x-text=\"ev.evidence_type || '-'\"></span></td><td class=\"px-4 py-3\"><span class=\"px-2 py-0.5 text-xs rounded\" :class=\"evidenceStatusClass(ev.status)\" x-text=\"ev.status || '-'\"></span></td><td class=\"px-4 py-3 text-sm text-gray-400 whitespace-nowrap\" x-text=\"formatTimestamp(ev.collected_at)\"></td></tr></template></tbody></table></div><!-- Evidence Empty State --><div x-show=\"!loadingEvidence && evidenceList.length === 0 && selectedAssessmentForEvidence\" x-cloak class=\"card p-12 text-center\"><i class=\"fas fa-file-alt text-4xl text-gray-400 mb-4\"></i><h3 class=\"text-lg font-medium text-white mb-2\">No Evidence</h3><p class=\"text-gray-400 mb-4\">No evidence has been collected for this assessment yet</p><button @click=\"showAddEvidenceModal = true\" class=\"btn-primary\"><i class=\"fas fa-plus mr-2\"></i>Add Evidence</button></div><div x-show=\"!selectedAssessmentForEvidence\" x-cloak class=\"card p-12 text-center\"><i class=\"fas fa-arrow-up text-4xl text-gray-400 mb-4\"></i><h3 class=\"text-lg font-medium text-white mb-2\">Select an Assessment</h3><p class=\"text-gray-400\">Choose an assessment from the dropdown to view or add evidence</p></div></div></div><!-- ==================== FRAMEWORK DETAIL MODAL (Controls) ==================== --><div x-show=\"showControlsModal\" x-cloak class=\"fixed inset-0 z-50 flex items-center justify-center bg-black/60\"><div class=\"bg-dark-800 rounded-xl shadow-xl border border-dark-600 w-full max-w-4xl mx-4 max-h-[90vh] flex flex-col\"><div class=\"flex items-center justify-between p-6 border-b border-dark-600 shrink-0\"><div><h2 class=\"text-lg font-display font-bold text-white\" x-text=\"(selectedFramework ? (selectedFramework.display_name || selectedFramework.name) : '') + ' Controls'\"></h2><p class=\"text-sm text-gray-400 mt-0.5\" x-text=\"controls.length + ' controls'\"></p></div><button @click=\"showControlsModal = false\" class=\"text-gray-400 hover:text-white\"><i class=\"fas fa-times\"></i></button></div><div class=\"p-6 overflow-y-auto flex-1 space-y-4\"><!-- Controls Loading --><div x-show=\"loadingControls\" class=\"p-8 text-center\"><i class=\"fas fa-spinner fa-spin text-xl text-gray-400 mb-2\"></i><p class=\"text-sm text-gray-400\">Loading controls...</p></div><!-- Controls Filters --><div x-show=\"!loadingControls && controls.length > 0\" class=\"flex items-center gap-3\"><select x-model=\"controlStatusFilter\" class=\"input text-sm\"><option value=\"\">All Statuses</option> <option value=\"not_started\">Not Started</option> <option value=\"in_progress\">In Progress</option> <option value=\"implemented\">Implemented</option> <option value=\"not_applicable\">Not Applicable</option></select> <select x-model=\"controlSeverityFilter\" class=\"input text-sm\"><option value=\"\">All Severities</option> <option value=\"critical\">Critical</option> <option value=\"high\">High</option> <option value=\"medium\">Medium</option> <option value=\"low\">Low</option></select> <span class=\"text-sm text-gray-400\" x-text=\"filteredControls().length + ' controls'\"></span></div><!-- Controls Table --><div x-show=\"!loadingControls && controls.length > 0\" x-cloak class=\"overflow-hidden rounded-lg border border-dark-700\"><table class=\"w-full\"><thead><tr class=\"border-b border-dark-600 bg-dark-900/50\"><th class=\"text-left text-xs font-medium text-gray-400 uppercase px-4 py-3\">Control ID</th><th class=\"text-left text-xs font-medium text-gray-400 uppercase px-4 py-3\">Title</th><th class=\"text-left text-xs font-medium text-gray-400 uppercase px-4 py-3\">Category</th><th class=\"text-left text-xs font-medium text-gray-400 uppercase px-4 py-3\">Severity</th><th class=\"text-left text-xs font-medium text-gray-400 uppercase px-4 py-3\">Status</th></tr></thead> <tbody class=\"divide-y divide-dark-700\"><template x-for=\"ctrl in filteredControls()\" :key=\"ctrl.id\"><tr class=\"hover:bg-dark-700/50\"><td class=\"px-4 py-3 text-sm text-primary-400 font-mono\" x-text=\"ctrl.control_id\"></td><td class=\"px-4 py-3\"><div class=\"font-medium text-white text-sm\" x-text=\"ctrl.title\"></div><div class=\"text-xs text-gray-500 mt-0.5 max-w-[300px] truncate\" x-text=\"ctrl.description\"></div></td><td class=\"px-4 py-3\"><span class=\"px-2 py-0.5 text-xs bg-dark-600 text-gray-300 rounded\" x-text=\"ctrl.category || '-'\"></span></td><td class=\"px-4 py-3\"><span class=\"px-2 py-0.5 text-xs rounded\" :class=\"severityClass(ctrl.severity)\" x-text=\"ctrl.severity\"></span></td><td class=\"px-4 py-3\"><select :value=\"ctrl.implementation_status\" @change=\"updateControlStatus(ctrl.id, $event.target.value)\" class=\"input text-xs py-1 px-2\"><option value=\"not_started\">Not Started</option> <option value=\"in_progress\">In Progress</option> <option value=\"implemented\">Implemented</option> <option value=\"not_applicable\">Not Applicable</option></select></td></tr></template></tbody></table></div><!-- Controls Empty --><div x-show=\"!loadingControls && controls.length === 0\" x-cloak class=\"p-8 text-center\"><i class=\"fas fa-list text-2xl text-gray-400 mb-2\"></i><p class=\"text-sm text-gray-400\">No controls found for this framework</p></div></div></div></div><!-- ==================== ASSESSMENT HISTORY MODAL ==================== --><div x-show=\"showHistoryModal\" x-cloak class=\"fixed inset-0 z-50 flex items-center justify-center bg-black/60\"><div class=\"bg-dark-800 rounded-xl shadow-xl border border-dark-600 w-full max-w-3xl mx-4 max-h-[90vh] flex flex-col\"><div class=\"flex items-center justify-between p-6 border-b border-dark-600 shrink-0\"><div><h2 class=\"text-lg font-display font-bold text-white\" x-text=\"(selectedFramework ? (selectedFramework.display_name || selectedFramework.name) : '') + ' Assessment History'\"></h2><p class=\"text-sm text-gray-400 mt-0.5\" x-text=\"historyAssessments.length + ' assessments'\"></p></div><button @click=\"showHistoryModal = false\" class=\"text-gray-400 hover:text-white\"><i class=\"fas fa-times\"></i></button></div><div class=\"p-6 overflow-y-auto flex-1\"><!-- History Loading --><div x-show=\"loadingHistory\" class=\"p-8 text-center\"><i class=\"fas fa-spinner fa-spin text-xl text-gray-400 mb-2\"></i><p class=\"text-sm text-gray-400\">Loading assessment history...</p></div><!-- History Table --><div x-show=\"!loadingHistory && historyAssessments.length > 0\" x-cloak class=\"overflow-hidden rounded-lg border border-dark-700\"><table class=\"w-full\"><thead><tr class=\"border-b border-dark-600 bg-dark-900/50\"><th class=\"text-left text-xs font-medium text-gray-400 uppercase px-4 py-3\">Name</th><th class=\"text-left text-xs font-medium text-gray-400 uppercase px-4 py-3\">Score</th><th class=\"text-left text-xs font-medium text-gray-400 uppercase px-4 py-3\">Passed / Failed</th><th class=\"text-left text-xs font-medium text-gray-400 uppercase px-4 py-3\">Date</th><th class=\"text-left text-xs font-medium text-gray-400 uppercase px-4 py-3\">Report</th></tr></thead> <tbody class=\"divide-y divide-dark-700\"><template x-for=\"a in historyAssessments\" :key=\"a.id\"><tr class=\"hover:bg-dark-700/50\"><td class=\"px-4 py-3\"><div class=\"text-sm text-white\" x-text=\"a.name || 'Assessment'\"></div><div class=\"text-xs text-gray-500 font-mono\" x-text=\"a.id.substring(0, 8)\"></div></td><td class=\"px-4 py-3\"><span class=\"text-sm font-bold\" :class=\"scoreColor(a.score)\" x-text=\"a.score != null ? Math.round(a.score) + '%' : '--'\"></span></td><td class=\"px-4 py-3 text-sm\"><span class=\"text-green-400\" x-text=\"a.passed_controls || 0\"></span> <span class=\"text-gray-600\">/ </span> <span class=\"text-red-400\" x-text=\"a.failed_controls || 0\"></span></td><td class=\"px-4 py-3 text-sm text-gray-400 whitespace-nowrap\" x-text=\"formatTimestamp(a.completed_at || a.started_at)\"></td><td class=\"px-4 py-3\"><div class=\"flex items-center gap-1\"><button @click=\"downloadReport(a.id, 'json')\" class=\"p-1.5 text-gray-400 hover:text-blue-400 transition-colors\" title=\"JSON report\"><i class=\"fas fa-file-code text-sm\"></i></button> <button @click=\"downloadReport(a.id, 'html')\" class=\"p-1.5 text-gray-400 hover:text-green-400 transition-colors\" title=\"HTML report\"><i class=\"fas fa-file-alt text-sm\"></i></button></div></td></tr></template></tbody></table></div><!-- History Empty --><div x-show=\"!loadingHistory && historyAssessments.length === 0\" x-cloak class=\"p-8 text-center\"><i class=\"fas fa-history text-2xl text-gray-400 mb-2\"></i><p class=\"text-sm text-gray-400\">No assessments have been run for this framework yet</p></div></div></div></div><!-- ==================== ASSESSMENT DETAIL MODAL ==================== --><div x-show=\"showDetailModal\" x-cloak class=\"fixed inset-0 z-50 flex items-center justify-center bg-black/60\"><div class=\"bg-dark-800 rounded-xl shadow-xl border border-dark-600 w-full max-w-4xl mx-4 max-h-[90vh] flex flex-col\"><div class=\"flex items-center justify-between p-6 border-b border-dark-600 shrink-0\"><div><h2 class=\"text-lg font-display font-bold text-white\" x-text=\"detailAssessment ? (detailAssessment.name || 'Assessment Detail') : 'Assessment Detail'\"></h2><p class=\"text-sm text-gray-400 mt-0.5\" x-text=\"'Framework: ' + frameworkNameById(detailAssessment ? detailAssessment.framework_id : null)\"></p></div><button @click=\"showDetailModal = false\" class=\"text-gray-400 hover:text-white\"><i class=\"fas fa-times\"></i></button></div><div class=\"p-6 overflow-y-auto flex-1 space-y-6\"><!-- Score Ring and Summary --><div x-show=\"detailAssessment\" class=\"flex items-center gap-8\"><div class=\"relative w-28 h-28 shrink-0\"><svg class=\"w-28 h-28 -rotate-90\" viewBox=\"0 0 120 120\"><circle cx=\"60\" cy=\"60\" r=\"52\" fill=\"none\" stroke=\"#1e293b\" stroke-width=\"10\"></circle> <circle cx=\"60\" cy=\"60\" r=\"52\" fill=\"none\" :stroke=\"scoreRingStroke(detailAssessment ? detailAssessment.score : null)\" stroke-width=\"10\" stroke-linecap=\"round\" :stroke-dasharray=\"2 * Math.PI * 52\" :stroke-dashoffset=\"2 * Math.PI * 52 * (1 - (detailAssessment ? (detailAssessment.score || 0) : 0) / 100)\"></circle></svg><div class=\"absolute inset-0 flex items-center justify-center\"><span class=\"text-2xl font-bold text-white\" x-text=\"detailAssessment && detailAssessment.score != null ? Math.round(detailAssessment.score) + '%' : '--'\"></span></div></div><div class=\"grid grid-cols-2 gap-4\"><div class=\"card p-3 text-center\"><p class=\"text-lg font-bold text-white\" x-text=\"detailAssessment ? detailAssessment.total_controls || 0 : 0\"></p><p class=\"text-xs text-gray-400\">Total</p></div><div class=\"card p-3 text-center\"><p class=\"text-lg font-bold text-green-400\" x-text=\"detailAssessment ? detailAssessment.passed_controls || 0 : 0\"></p><p class=\"text-xs text-gray-400\">Passed</p></div><div class=\"card p-3 text-center\"><p class=\"text-lg font-bold text-red-400\" x-text=\"detailAssessment ? detailAssessment.failed_controls || 0 : 0\"></p><p class=\"text-xs text-gray-400\">Failed</p></div><div class=\"card p-3 text-center\"><p class=\"text-lg font-bold text-blue-400\" x-text=\"detailAssessment ? detailAssessment.na_controls || 0 : 0\"></p><p class=\"text-xs text-gray-400\">N/A</p></div></div></div><!-- Control Results (collapsible) --><div x-show=\"detailAssessment && detailAssessment.results && detailAssessment.results.length > 0\"><h3 class=\"text-sm font-medium text-gray-300 mb-3\">Control Results</h3><div class=\"space-y-1\"><template x-for=\"(result, idx) in (detailAssessment ? detailAssessment.results || [] : [])\" :key=\"idx\"><div class=\"border border-dark-700 rounded-lg overflow-hidden\"><button @click=\"result._open = !result._open\" class=\"w-full flex items-center justify-between px-4 py-2.5 hover:bg-dark-700/50 transition-colors\"><div class=\"flex items-center gap-3\"><i class=\"fas fa-circle text-[8px]\" :class=\"result.passed ? 'text-green-400' : (result.status === 'not_applicable' ? 'text-blue-400' : 'text-red-400')\"></i> <span class=\"text-sm text-white font-mono\" x-text=\"result.control_id || ('Control ' + (idx + 1))\"></span> <span class=\"text-sm text-gray-400\" x-text=\"result.title || ''\"></span></div><i class=\"fas text-gray-500 text-xs\" :class=\"result._open ? 'fa-chevron-up' : 'fa-chevron-down'\"></i></button><div x-show=\"result._open\" x-cloak class=\"px-4 py-3 border-t border-dark-700 bg-dark-900/50\"><div class=\"grid grid-cols-2 gap-4 text-sm\"><div><p class=\"text-gray-500 text-xs mb-0.5\">Status</p><span class=\"px-2 py-0.5 text-xs rounded\" :class=\"result.passed ? 'bg-green-500/20 text-green-400' : 'bg-red-500/20 text-red-400'\" x-text=\"result.passed ? 'Passed' : 'Failed'\"></span></div><div><p class=\"text-gray-500 text-xs mb-0.5\">Severity</p><span class=\"px-2 py-0.5 text-xs rounded\" :class=\"severityClass(result.severity)\" x-text=\"result.severity || '-'\"></span></div></div><div x-show=\"result.message\" class=\"mt-3\"><p class=\"text-gray-500 text-xs mb-0.5\">Details</p><p class=\"text-sm text-gray-300\" x-text=\"result.message\"></p></div><div x-show=\"result.remediation\" class=\"mt-3\"><p class=\"text-gray-500 text-xs mb-0.5\">Remediation</p><p class=\"text-sm text-gray-300\" x-text=\"result.remediation\"></p></div></div></div></template></div></div></div></div></div><!-- ==================== ADD EVIDENCE MODAL ==================== --><div x-show=\"showAddEvidenceModal\" x-cloak class=\"fixed inset-0 z-50 flex items-center justify-center bg-black/60\"><div class=\"bg-dark-800 rounded-xl shadow-xl border border-dark-600 w-full max-w-lg mx-4\"><div class=\"flex items-center justify-between p-6 border-b border-dark-600\"><h2 class=\"text-lg font-display font-bold text-white\">Add Evidence</h2><button @click=\"showAddEvidenceModal = false\" class=\"text-gray-400 hover:text-white\"><i class=\"fas fa-times\"></i></button></div><div class=\"p-6 space-y-4\"><div><label class=\"block text-sm font-medium text-gray-300 mb-1\">Title</label> <input type=\"text\" x-model=\"newEvidence.title\" class=\"input w-full\" placeholder=\"Evidence title\"></div><div><label class=\"block text-sm font-medium text-gray-300 mb-1\">Control ID</label> <input type=\"text\" x-model=\"newEvidence.control_id\" class=\"input w-full font-mono\" placeholder=\"e.g. SOC2-CC6.1\"></div><div><label class=\"block text-sm font-medium text-gray-300 mb-1\">Evidence Type</label> <select x-model=\"newEvidence.evidence_type\" class=\"input w-full\"><option value=\"manual\">Manual</option> <option value=\"automated\">Automated</option> <option value=\"screenshot\">Screenshot</option> <option value=\"log\">Log</option> <option value=\"document\">Document</option></select></div><div><label class=\"block text-sm font-medium text-gray-300 mb-1\">Description</label> <textarea x-model=\"newEvidence.description\" rows=\"2\" class=\"input w-full\" placeholder=\"Describe the evidence\"></textarea></div><div><label class=\"block text-sm font-medium text-gray-300 mb-1\">Data (JSON)</label> <textarea x-model=\"newEvidence.data\" rows=\"3\" class=\"input w-full font-mono text-sm\" placeholder='{\"key\": \"value\"}'></textarea></div><div class=\"flex justify-end gap-3 pt-4 border-t border-dark-600\"><button @click=\"showAddEvidenceModal = false\" class=\"btn-secondary\">Cancel</button> <button @click=\"createEvidence()\" :disabled=\"!newEvidence.title.trim() || addingEvidence\" class=\"btn-primary disabled:opacity-50\"><i class=\"fas fa-plus mr-2\" :class=\"addingEvidence && 'animate-spin'\"></i> <span x-text=\"addingEvidence ? 'Adding...' : 'Add Evidence'\"></span></button></div></div></div></div></div>")
			if templ_7745c5c3_Err != nil {
				return templ_7745c5c3_Err
			}
			return nil
		})
		templ_7745c5c3_Err = layouts.Base(data.PageData).Render(templ.WithChildren(ctx, templ_7745c5c3_Var2), templ_7745c5c3_Buffer)
		if templ_7745c5c3_Err != nil {
			return templ_7745c5c3_Err
		}
		return nil
	})
}

func complianceAlpineInit(csrfToken string) string {
	return `{
		tab: 'frameworks',
		csrfToken: '` + csrfToken + `',

		frameworks: [],
		loading: true,
		error: null,
		seeding: false,

		controls: [],
		loadingControls: false,
		controlStatusFilter: '',
		controlSeverityFilter: '',
		showControlsModal: false,
		selectedFramework: null,

		historyAssessments: [],
		loadingHistory: false,
		showHistoryModal: false,

		allAssessments: [],
		loadingAssessments: false,

		detailAssessment: null,
		showDetailModal: false,

		evidenceList: [],
		loadingEvidence: false,
		selectedAssessmentForEvidence: '',
		showAddEvidenceModal: false,
		addingEvidence: false,
		newEvidence: { title: '', control_id: '', evidence_type: 'manual', description: '', data: '' },

		init() {
			this.fetchFrameworks();
		},

		async fetchFrameworks() {
			this.loading = true;
			this.error = null;
			try {
				var resp = await fetch('/api/v1/compliance/frameworks');
				if (!resp.ok) { var eb = await resp.json().catch(function() { return null; }); throw new Error((eb && eb.error) ? eb.error : 'HTTP ' + resp.status); }
				var data = await resp.json();
				this.frameworks = Array.isArray(data) ? data : [];
				for (var i = 0; i < this.frameworks.length; i++) {
					this.frameworks[i]._assessing = false;
					this.frameworks[i]._status = null;
				}
				this.fetchAllStatuses();
				this.fetchAllAssessments();
			} catch (e) {
				this.error = e.message || 'Failed to fetch frameworks';
				this.frameworks = [];
			} finally {
				this.loading = false;
			}
		},

		async fetchAllStatuses() {
			var self = this;
			var promises = this.frameworks.map(function(fw) {
				return fetch('/api/v1/compliance/frameworks/' + encodeURIComponent(fw.id) + '/status')
					.then(function(resp) {
						if (resp.ok) return resp.json();
						return null;
					})
					.then(function(data) {
						if (data) fw._status = data;
					})
					.catch(function() {});
			});
			await Promise.all(promises);
		},

		async seedFrameworks() {
			this.seeding = true;
			try {
				var resp = await fetch('/api/v1/compliance/frameworks/seed', {
					method: 'POST',
					headers: { 'X-CSRF-Token': this.csrfToken }
				});
				if (!resp.ok) { var eb = await resp.json().catch(function() { return null; }); throw new Error((eb && eb.error) ? eb.error : 'HTTP ' + resp.status); }
				if (window.usulnet) { window.usulnet.toast('Default frameworks seeded', 'success'); }
				await this.fetchFrameworks();
			} catch (e) {
				var msg = e.message || 'Failed to seed frameworks';
				if (window.usulnet) { window.usulnet.toast(msg, 'error'); } else { console.error(msg); }
			} finally {
				this.seeding = false;
			}
		},

		async openFrameworkDetail(fw) {
			this.selectedFramework = fw;
			this.controls = [];
			this.controlStatusFilter = '';
			this.controlSeverityFilter = '';
			this.showControlsModal = true;
			this.loadingControls = true;
			try {
				var resp = await fetch('/api/v1/compliance/frameworks/' + encodeURIComponent(fw.id) + '/controls');
				if (!resp.ok) { var eb = await resp.json().catch(function() { return null; }); throw new Error((eb && eb.error) ? eb.error : 'HTTP ' + resp.status); }
				var data = await resp.json();
				this.controls = Array.isArray(data) ? data : [];
			} catch (e) {
				var msg = e.message || 'Failed to fetch controls';
				if (window.usulnet) { window.usulnet.toast(msg, 'error'); } else { console.error(msg); }
			} finally {
				this.loadingControls = false;
			}
		},

		filteredControls() {
			var self = this;
			return this.controls.filter(function(c) {
				if (self.controlStatusFilter && c.implementation_status !== self.controlStatusFilter) return false;
				if (self.controlSeverityFilter && c.severity !== self.controlSeverityFilter) return false;
				return true;
			});
		},

		async updateControlStatus(controlId, newStatus) {
			try {
				var resp = await fetch('/api/v1/compliance/controls/' + encodeURIComponent(controlId) + '/status', {
					method: 'PUT',
					headers: {
						'Content-Type': 'application/json',
						'X-CSRF-Token': this.csrfToken
					},
					body: JSON.stringify({ implementation_status: newStatus })
				});
				if (!resp.ok) { var eb = await resp.json().catch(function() { return null; }); throw new Error((eb && eb.error) ? eb.error : 'HTTP ' + resp.status); }
				var ctrl = this.controls.find(function(c) { return c.id === controlId; });
				if (ctrl) { ctrl.implementation_status = newStatus; }
				if (window.usulnet) { window.usulnet.toast('Control status updated', 'success'); }
				if (this.selectedFramework) {
					this.fetchFrameworkStatus(this.selectedFramework);
				}
			} catch (e) {
				var msg = e.message || 'Failed to update control status';
				if (window.usulnet) { window.usulnet.toast(msg, 'error'); } else { console.error(msg); }
			}
		},

		async fetchFrameworkStatus(fw) {
			try {
				var resp = await fetch('/api/v1/compliance/frameworks/' + encodeURIComponent(fw.id) + '/status');
				if (resp.ok) {
					fw._status = await resp.json();
				}
			} catch (e) {
				// Non-blocking
			}
		},

		async runAssessment(fw) {
			fw._assessing = true;
			try {
				var resp = await fetch('/api/v1/compliance/frameworks/' + encodeURIComponent(fw.id) + '/assess', {
					method: 'POST',
					headers: { 'X-CSRF-Token': this.csrfToken }
				});
				if (!resp.ok) { var eb = await resp.json().catch(function() { return null; }); throw new Error((eb && eb.error) ? eb.error : 'HTTP ' + resp.status); }
				var result = await resp.json();
				if (window.usulnet) { window.usulnet.toast('Assessment complete â€” Score: ' + (result.score != null ? Math.round(result.score) + '%' : 'N/A'), 'success'); }
				await this.fetchFrameworkStatus(fw);
			} catch (e) {
				var msg = e.message || 'Assessment failed';
				if (window.usulnet) { window.usulnet.toast(msg, 'error'); } else { console.error(msg); }
			} finally {
				fw._assessing = false;
			}
		},

		async openAssessmentHistory(fw) {
			this.selectedFramework = fw;
			this.historyAssessments = [];
			this.showHistoryModal = true;
			this.loadingHistory = true;
			try {
				var resp = await fetch('/api/v1/compliance/frameworks/' + encodeURIComponent(fw.id) + '/assessments');
				if (!resp.ok) { var eb = await resp.json().catch(function() { return null; }); throw new Error((eb && eb.error) ? eb.error : 'HTTP ' + resp.status); }
				var data = await resp.json();
				this.historyAssessments = Array.isArray(data) ? data : [];
			} catch (e) {
				var msg = e.message || 'Failed to fetch assessment history';
				if (window.usulnet) { window.usulnet.toast(msg, 'error'); } else { console.error(msg); }
			} finally {
				this.loadingHistory = false;
			}
		},

		async fetchAllAssessments() {
			this.loadingAssessments = true;
			try {
				var assessments = [];
				for (var i = 0; i < this.frameworks.length; i++) {
					var fw = this.frameworks[i];
					try {
						var resp = await fetch('/api/v1/compliance/frameworks/' + encodeURIComponent(fw.id) + '/assessments');
						if (resp.ok) {
							var data = await resp.json();
							var items = Array.isArray(data) ? data : [];
							assessments = assessments.concat(items);
						}
					} catch (e) {
						// Skip frameworks that fail
					}
				}
				assessments.sort(function(a, b) {
					var dateA = a.completed_at || a.started_at || '';
					var dateB = b.completed_at || b.started_at || '';
					return dateB.localeCompare(dateA);
				});
				this.allAssessments = assessments;
			} finally {
				this.loadingAssessments = false;
			}
		},

		viewAssessmentDetail(assessment) {
			this.detailAssessment = JSON.parse(JSON.stringify(assessment));
			if (this.detailAssessment.results) {
				for (var i = 0; i < this.detailAssessment.results.length; i++) {
					this.detailAssessment.results[i]._open = false;
				}
			}
			this.showDetailModal = true;
		},

		async downloadReport(assessmentId, format) {
			try {
				var resp = await fetch('/api/v1/compliance/assessments/' + encodeURIComponent(assessmentId) + '/report?format=' + format);
				if (!resp.ok) { var eb = await resp.json().catch(function() { return null; }); throw new Error((eb && eb.error) ? eb.error : 'HTTP ' + resp.status); }
				var blob = await resp.blob();
				var url = window.URL.createObjectURL(blob);
				var a = document.createElement('a');
				a.href = url;
				a.download = 'compliance-report-' + assessmentId.substring(0, 8) + '.' + (format === 'html' ? 'html' : 'json');
				document.body.appendChild(a);
				a.click();
				document.body.removeChild(a);
				window.URL.revokeObjectURL(url);
				if (window.usulnet) { window.usulnet.toast('Report downloaded', 'success'); }
			} catch (e) {
				var msg = e.message || 'Failed to download report';
				if (window.usulnet) { window.usulnet.toast(msg, 'error'); } else { console.error(msg); }
			}
		},

		async fetchEvidence(assessmentId) {
			if (!assessmentId) return;
			this.loadingEvidence = true;
			try {
				var resp = await fetch('/api/v1/compliance/assessments/' + encodeURIComponent(assessmentId) + '/evidence');
				if (!resp.ok) { var eb = await resp.json().catch(function() { return null; }); throw new Error((eb && eb.error) ? eb.error : 'HTTP ' + resp.status); }
				var data = await resp.json();
				this.evidenceList = Array.isArray(data) ? data : [];
			} catch (e) {
				var msg = e.message || 'Failed to fetch evidence';
				if (window.usulnet) { window.usulnet.toast(msg, 'error'); } else { console.error(msg); }
				this.evidenceList = [];
			} finally {
				this.loadingEvidence = false;
			}
		},

		async createEvidence() {
			if (!this.selectedAssessmentForEvidence || !this.newEvidence.title.trim()) return;
			this.addingEvidence = true;
			var dataObj = null;
			if (this.newEvidence.data.trim()) {
				try {
					dataObj = JSON.parse(this.newEvidence.data);
				} catch (e) {
					if (window.usulnet) { window.usulnet.toast('Invalid JSON in data field', 'error'); }
					this.addingEvidence = false;
					return;
				}
			}
			try {
				var resp = await fetch('/api/v1/compliance/assessments/' + encodeURIComponent(this.selectedAssessmentForEvidence) + '/evidence', {
					method: 'POST',
					headers: {
						'Content-Type': 'application/json',
						'X-CSRF-Token': this.csrfToken
					},
					body: JSON.stringify({
						title: this.newEvidence.title,
						control_id: this.newEvidence.control_id,
						evidence_type: this.newEvidence.evidence_type,
						description: this.newEvidence.description,
						data: dataObj
					})
				});
				if (!resp.ok) { var eb = await resp.json().catch(function() { return null; }); throw new Error((eb && eb.error) ? eb.error : 'HTTP ' + resp.status); }
				this.showAddEvidenceModal = false;
				this.newEvidence = { title: '', control_id: '', evidence_type: 'manual', description: '', data: '' };
				if (window.usulnet) { window.usulnet.toast('Evidence added', 'success'); }
				await this.fetchEvidence(this.selectedAssessmentForEvidence);
			} catch (e) {
				var msg = e.message || 'Failed to add evidence';
				if (window.usulnet) { window.usulnet.toast(msg, 'error'); } else { console.error(msg); }
			} finally {
				this.addingEvidence = false;
			}
		},

		frameworkNameById(fwId) {
			if (!fwId) return '-';
			var fw = this.frameworks.find(function(f) { return f.id === fwId; });
			return fw ? (fw.display_name || fw.name) : fwId.substring(0, 8);
		},

		formatTimestamp(ts) {
			if (!ts) return '-';
			try {
				var d = new Date(ts);
				return d.toLocaleString();
			} catch (e) {
				return ts;
			}
		},

		scoreColor(score) {
			if (score == null) return 'text-gray-400';
			if (score >= 80) return 'text-green-400';
			if (score >= 60) return 'text-yellow-400';
			if (score >= 40) return 'text-orange-400';
			return 'text-red-400';
		},

		scoreBarColor(score) {
			if (score == null) return 'bg-gray-600';
			if (score >= 80) return 'bg-green-500';
			if (score >= 60) return 'bg-yellow-500';
			if (score >= 40) return 'bg-orange-500';
			return 'bg-red-500';
		},

		scoreRingStroke(score) {
			if (score == null) return '#6b7280';
			if (score >= 80) return '#22c55e';
			if (score >= 60) return '#eab308';
			if (score >= 40) return '#f97316';
			return '#ef4444';
		},

		severityClass(severity) {
			switch (severity) {
				case 'critical': return 'bg-red-500/20 text-red-400';
				case 'high': return 'bg-orange-500/20 text-orange-400';
				case 'medium': return 'bg-yellow-500/20 text-yellow-400';
				case 'low': return 'bg-blue-500/20 text-blue-400';
				default: return 'bg-gray-500/20 text-gray-400';
			}
		},

		assessmentStatusClass(status) {
			switch (status) {
				case 'completed': return 'bg-green-500/20 text-green-400';
				case 'running': return 'bg-blue-500/20 text-blue-400';
				case 'failed': return 'bg-red-500/20 text-red-400';
				case 'pending': return 'bg-yellow-500/20 text-yellow-400';
				default: return 'bg-gray-500/20 text-gray-400';
			}
		},

		evidenceStatusClass(status) {
			switch (status) {
				case 'verified': return 'bg-green-500/20 text-green-400';
				case 'pending': return 'bg-yellow-500/20 text-yellow-400';
				case 'rejected': return 'bg-red-500/20 text-red-400';
				default: return 'bg-gray-500/20 text-gray-400';
			}
		},

		frameworkIcon(name) {
			if (!name) return 'fa-shield-alt';
			var n = name.toLowerCase();
			if (n.indexOf('soc') !== -1) return 'fa-shield-alt text-blue-400';
			if (n.indexOf('hipaa') !== -1) return 'fa-heartbeat text-red-400';
			if (n.indexOf('pci') !== -1) return 'fa-credit-card text-purple-400';
			if (n.indexOf('iso') !== -1) return 'fa-certificate text-green-400';
			if (n.indexOf('gdpr') !== -1) return 'fa-user-shield text-cyan-400';
			return 'fa-balance-scale text-primary-400';
		},

		frameworkIconBg(name) {
			if (!name) return 'bg-primary-500/20';
			var n = name.toLowerCase();
			if (n.indexOf('soc') !== -1) return 'bg-blue-500/20';
			if (n.indexOf('hipaa') !== -1) return 'bg-red-500/20';
			if (n.indexOf('pci') !== -1) return 'bg-purple-500/20';
			if (n.indexOf('iso') !== -1) return 'bg-green-500/20';
			if (n.indexOf('gdpr') !== -1) return 'bg-cyan-500/20';
			return 'bg-primary-500/20';
		}
	}`
}

var _ = templruntime.GeneratedTemplate
